@model PrayerTracker1.Models.UserVM.UserVM

<div class="container-fluid mt-4">
    <div class="card shadow-lg p-4">
        <h2 class="text-white bg-gradient-primary p-3 rounded shadow text-center mb-4" style="background: linear-gradient(135deg, #0062E6 0%, #33AEFF 100%);">
            <i class="fas fa-users me-2"></i>User Management
        </h2>

        <div class="mb-3 col-sm-6">
            <input type="text" id="searchInput" class="form-control" placeholder="Search users...">
        </div>

        <div class="table-responsive">
            <table class="table table-hover table-bordered text-center">
                <thead class="table-primary text-white">
                    <tr>
                        <th>#</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Role</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="userTable">
                    @if ( Model.UserProfileList != null)
                    {
                        int count = 1;
                        foreach (var user in Model.UserProfileList)
                        {
                            var profile = Model.UserProfileList.FirstOrDefault(p => p.ID == user.ID);
                            string statusClass = (profile != null && profile.status) ? "bg-success" : "bg-danger";
                            string statusText = (profile != null && profile.status) ? "Active" : "Inactive";

                            <tr>
                                <td>@count</td>
                                <td>@user.FirstName</td>
                                <td>@user.Email</td>
                                <td>@user.Role</td>
                                <td><span class="badge @statusClass text-white">@statusText</span></td>
                                 <td>
                                        <a href="@Url.Action("UpdateProfile", "Admin", new { id = user.Fk_UserID})" class="btn btn-sm btn-outline-primary">
                                            <i class="fas fa-edit"></i> Edit
                                        </a>
                                        <a href="@Url.Action("EditUserStatus", "Admin", new { id = user.ID})" class="btn btn-sm  @(user.status? "btn-outline-danger" : "btn-outline-success")" onclick="return confirm('Are you sure you want to enable/disable this user?');">
                                            <i class="fas @(user.status ? "fa-times" : "fa-check")"></i> @(user.status ? "Disable" : "Enable")
                                        </a>
                                        <a href="@Url.Action("Delete", "Admin", new { id = user.Fk_UserID })" class="btn btn-outline-warning btn-sm" onclick="return confirm('Are you sure you want to delete this user?');">
                                            <i class="fas fa-trash"></i> Delete
                                        </a>
                                    </td>
                            </tr>
                            count++;
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="6" class="text-danger">No users found.</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    document.getElementById("searchInput").addEventListener("keyup", function () {
        let value = this.value.toLowerCase();
        let rows = document.querySelectorAll("#userTable tr");

        rows.forEach(row => {
            row.style.display = row.innerText.toLowerCase().includes(value) ? "" : "none";
        });
    });
</script>
